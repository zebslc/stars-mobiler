# Stellar Remnants — Combat & AI (Phase 4)

## Problem Statement
Provide auto-resolved combat with pre-battle prediction and basic AI personalities capable of expansion and military actions.

## Scope
- In scope: Fleet strength calculation, battle zones, contested battle resolution, pre-combat forecast UI, bombardment rules; AI loop with two personalities and difficulty scaling.
- Out of scope: Battle replay; multiple AIs beyond MVP.

## Requirements
- Functional:
  - Strength computed from design firepower, durability, accuracy, initiative with diminishing returns for stacks.
  - Battle zones determine deterministic vs contested outcomes; contested resolves via up to 10 rounds and possible defender retreat.
  - Bombardment reduces population/installations; cannot capture without colonization.
  - Pre-combat UI presents forecast zone, ratio, likely losses; actions: Retreat/Engage.
  - AI loop updates perception, decides builds, fleet movement, and research focus based on personality and difficulty.
- Nonfunctional:
  - Deterministic when outside contested ranges; seeded randomness for contested outcomes.

## Acceptance Criteria
- Given two fleets, when strength ratio ≥ 2.5, then result is deterministic win with minimal losses.
- Given contested ratio, when resolving combat, then up to 10 rounds occur and defender may retreat after round 3 if losing badly.
- Given bombardment order, when resolving, then population and installations reduce per formula and defenses mitigate effect.
- Given AI set to Expansionist Easy, when playing 10 turns, then AI colonizes nearby worlds and builds minimal military.

## UX Outline
- Battle Forecast modal with fleet summaries, ratio bar, prediction zone, and actions.
- Turn Summary includes combat results and alerts.

## Data Contracts
- Combat calculations use `CompiledDesign` stats; logs include battle rounds, outcome type, losses.
- AI brain tracks threatMap, targets, personality, difficulty; outputs buildOrders, fleetOrders, researchFocus.

## Open Questions
- Loss modeling for deterministic wins to ensure believable results.
- Personality tuning and difficulty scaling values.

